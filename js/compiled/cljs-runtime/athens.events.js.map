{"version":3,"sources":["athens/events.cljs"],"mappings":"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","names":["cljs.core/deref","athens.events/get-block","id","G__54508","G__54509","G__54510","posh.reagent/pull","athens.db/dsdb","athens.events/get-parent","eid","G__54511","G__54512","datascript.core/entity","cljs.core/first","re_frame.core.reg_event_db.cljs$core$IFn$_invoke$arity$2","day8.re-frame.tracing/is-trace-enabled?","+debux-dbg-opts+","debux.common.util/send-form!","opts__54409__auto__","result__54410__auto__","debux.common.util/send-trace!","e","e54513","_","athens.db/rfdb","db","cljs.core.update.cljs$core$IFn$_invoke$arity$3","cljs.core/not","p__54514","vec__54515","cljs.core.nth.cljs$core$IFn$_invoke$arity$3","item","cljs.core.update_in.cljs$core$IFn$_invoke$arity$3","p__54518","vec__54519","G__54524","fexpr__54523","e54522","p__54525","vec__54526","selected-page","fexpr__54529","cljs.core/set","cljs.core.update.cljs$core$IFn$_invoke$arity$4","cljs.core/conj","p__54530","vec__54531","uid","cljs.core/dissoc","re_frame.core.reg_event_fx.cljs$core$IFn$_invoke$arity$2","p__54534","p__54535","map__54536","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","cljs.core.get.cljs$core$IFn$_invoke$arity$2","vec__54537","G__54542","G__54543","G__54544","e54541","p__54545","p__54546","map__54547","vec__54548","block","G__54552","G__54553","G__54554","datascript.core/pull","new-item","cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic","new-items","cljs.core.assoc.cljs$core$IFn$_invoke$arity$3","inc-items","cljs.core/reduce-kv","m","k","v","cljs.core/inc","sorted-items","cljs.core.into.cljs$core$IFn$_invoke$arity$2","cljs.core/sorted-map-by","k1","k2","cljs.core/compare","cljs.core.get_in.cljs$core$IFn$_invoke$arity$2","e54555","error","cljs.core/assoc-in","e54556","e54557","e54558","p__54559","vec__54560","e54563","p__54564","vec__54565","p__54568","vec__54569","map","p__54572","vec__54573","e54576","athens.db/athens-url","p__54577","vec__54578","json-str","datoms","athens.db/str-to-db-tx","new-db","datascript.core/db-with","datascript.core/empty-db","athens.db/schema","p__54581","map__54582","temp__5733__auto__","stored","js/localStorage.getItem","datascript.transit/read-transit-str","p__54584","vec__54585","temp__5735__auto__","prev","p1__54588#","athens.db/find-prev","athens.db/history","next","p1__54589#","athens.db/find-next","p__54590","vec__54591","title","now","athens.util/now-ts","p__54594","p__54595","map__54596","vec__54597","map__54600","athens.db/e-by-av","athens.events/rules","p__54603","vec__54604","_uid","athens.events/split-block","val","sel-start","parent","head","cljs.core.subs.cljs$core$IFn$_invoke$arity$3","tail","cljs.core.subs.cljs$core$IFn$_invoke$arity$2","new-uid","athens.util/gen-block-uid","new-block","reindex","G__54611","G__54612","G__54613","G__54614","G__54615","datascript.core/q","cljs.core.map.cljs$core$IFn$_invoke$arity$2","p__54607","vec__54608","order","cljs.core.concat.cljs$core$IFn$_invoke$arity$2","athens.events/bump-up","G__54620","G__54621","G__54622","G__54623","G__54624","p__54616","vec__54617","p__54625","vec__54626","cljs.core/empty?","p__54630","vec__54631","older-sib","p1__54629#","cljs.core.filter.cljs$core$IFn$_invoke$arity$2","cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2","cljs.core/count","reindex-blocks","G__54638","G__54639","G__54640","G__54641","G__54642","p__54634","vec__54635","p__54643","vec__54644","grandpa","reindex-grandpa","G__54651","G__54652","G__54653","G__54654","G__54655","p__54647","vec__54648","and__4174__auto__","athens.events/target-child","source","source-parent","target","new-parent-children","G__54660","G__54661","G__54662","G__54663","G__54664","p__54656","vec__54657","new-target-children","G__54669","G__54670","G__54671","G__54672","G__54673","p__54665","vec__54666","athens.events/between","s","t","x","athens.events/target-sibling-same-parent","t-order","s-order","inc-or-dec","cljs.core/dec","G__54678","G__54679","G__54680","G__54681","G__54682","G__54683","G__54684","p__54674","vec__54675","athens.events/target-sibling-diff-parent","target-parent","source-parent-children","G__54689","G__54690","G__54691","G__54692","G__54693","p__54685","vec__54686","target-parent-children","G__54698","G__54699","G__54700","G__54701","G__54702","p__54694","vec__54695","p__54703","vec__54704","e54707","p__54708","vec__54709","source-uid","target-uid","kind","cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2"],"sourcesContent":["(ns athens.events\n  (:require\n    [athens.db :as db]\n    [athens.util :refer [now-ts gen-block-uid]]\n    [datascript.core :as d]\n    [datascript.transit :as dt]\n    [day8.re-frame.async-flow-fx]\n    [day8.re-frame.tracing :refer-macros [fn-traced]]\n    [posh.reagent :refer [pull #_q #_pull-many]]\n    [re-frame.core :refer [reg-event-db reg-event-fx]]))\n\n\n;; Utils\n\n\n(defn get-block\n  [id]\n  @(pull db/dsdb '[:db/id :block/uid :block/order {:block/children [:block/uid :block/order]}] id))\n\n\n(defn get-parent\n  [id]\n  (let [eid (-> (d/entity @db/dsdb id)\n              :block/_children\n              first\n              :db/id)]\n    (get-block eid)))\n\n\n\n;;; Events\n\n\n;; app-db events\n\n\n(reg-event-db\n  :init-rfdb\n  (fn-traced [_ _]\n             db/rfdb))\n\n\n(reg-event-db\n  :toggle-athena\n  (fn [db _]\n    (update db :athena/open not)))\n\n\n(reg-event-db\n  :toggle-devtool\n  (fn [db _]\n    (update db :devtool not)))\n\n\n(reg-event-db\n  :toggle-left-sidebar\n  (fn [db _]\n    (update db :left-sidebar not)))\n\n\n(reg-event-db\n  :right-sidebar/toggle\n  (fn [db _]\n    (update db :right-sidebar/open not)))\n\n\n(reg-event-db\n  :right-sidebar/toggle-item\n  (fn [db [_ item]]\n    (update-in db [:right-sidebar/items item :open] not)))\n\n\n(reg-event-db\n  :athena/update-recent\n  (fn-traced [db [_ selected-page]]\n    (when (nil? ((set (:athena/recent-items db)) selected-page))\n      (update db :athena/recent-items conj selected-page))))\n\n\n;; TODO: dec all indices > closed item\n(reg-event-db\n  :right-sidebar/close-item\n  (fn [db [_ uid]]\n    (update db :right-sidebar/items dissoc uid)))\n\n\n;; TODO: change right sidebar items from map to datascript\n(reg-event-fx\n  :right-sidebar/open-item\n  (fn-traced [{:keys [db]} [_ uid]]\n    (let [block     (d/pull @db/dsdb '[:node/title :block/string] [:block/uid uid])\n          new-item  (merge block {:open true :index -1})\n          new-items (assoc (:right-sidebar/items db) uid new-item)\n          inc-items (reduce-kv (fn [m k v] (assoc m k (update v :index inc)))\n                               {}\n                               new-items)\n          sorted-items (into (sorted-map-by (fn [k1 k2]\n                                              (compare\n                                                [(get-in new-items [k1 :index]) k2]\n                                                [(get-in new-items [k2 :index]) k1]))) inc-items)]\n      {:db (assoc db :right-sidebar/items sorted-items)\n       :dispatch (when (false? (:right-sidebar/open db))\n                   [:right-sidebar/toggle])})))\n\n\n(reg-event-db\n  :alert-failure\n  (fn-traced [db error]\n             (assoc-in db [:errors] error)))\n\n\n(reg-event-db\n  :clear-errors\n  (fn-traced [db]\n             (assoc-in db [:errors] {})))\n\n\n(reg-event-db\n  :set-loading\n  (fn-traced [db]\n    (assoc-in db [:loading] true)))\n\n\n(reg-event-db\n  :clear-loading\n  (fn-traced [db]\n             (assoc-in db [:loading] false)))\n\n\n(reg-event-db\n  :editing-uid\n  (fn-traced [db [_ uid]]\n             (assoc db :editing-uid uid)))\n\n\n(reg-event-db\n  :drag-bullet\n  (fn [db [_ map]]\n    (assoc db :drag-bullet map)))\n\n\n(reg-event-db\n  :tooltip-uid\n  (fn [db [_ uid]]\n    (assoc db :tooltip-uid uid)))\n\n\n;;; event effects\n\n\n(reg-event-fx\n  :boot ;; FIXME: rename to init-dsdb?\n  (fn-traced [_ _]\n             {:async-flow {:first-dispatch [:get-local-storage-db]\n                           :rules          [{:when :seen? :events :parse-datoms :dispatch [:clear-loading] :halt? true}\n                                            {:when :seen? :events :api-request-error :dispatch [:alert-failure \"Boot Error\"] :halt? true}]}}))\n\n\n(reg-event-fx\n  :get-datoms\n  (fn [_ _]\n    {:http {:method :get\n            :url db/athens-url\n            :opts {:with-credentials? false}\n            :on-success [:parse-datoms]\n            :on-failure [:alert-failure]}}))\n\n\n(reg-event-fx\n  :parse-datoms\n  (fn [_ [_ json-str]]\n    (let [datoms (db/str-to-db-tx json-str)\n          new-db (d/db-with (d/empty-db db/schema) datoms)]\n      {:reset-conn new-db\n       :set-local-storage-db new-db\n       :db (assoc db/rfdb :loading false)})))\n\n\n(reg-event-fx\n  :reset-dsdb\n  (fn []\n    {:reset-conn (d/empty-db db/schema)}))\n\n\n(reg-event-fx\n  :get-local-storage-db\n  (fn [{:keys [db]}]\n    (if-let [stored (js/localStorage.getItem \"datascript/DB\")]\n      {:reset-conn (dt/read-transit-str stored)\n       ;;:db         (assoc (assoc db/rfdb :loading false) :current-route (:current-route db))\n       :db         (merge db/rfdb {:loading false :current-route (:current-route db)})}\n      {:dispatch [:get-datoms]\n       :db       db/rfdb})))\n\n\n(reg-event-db\n  :daily-notes/reset\n  (fn [db _]\n    (assoc db :daily-notes [])))\n\n\n(reg-event-fx\n  :transact-event\n  (fn [_ [_ datoms]]\n    {:transact datoms}))\n\n\n(reg-event-fx\n  :undo\n  (fn [_ _]\n    (when-let [prev (db/find-prev @db/history #(identical? @db/dsdb %))]\n      {:reset-conn prev})))\n\n\n(reg-event-fx\n  :redo\n  (fn [_ _]\n    (when-let [next (db/find-next @db/history #(identical? @db/dsdb %))]\n      {:reset-conn next})))\n\n\n(reg-event-fx\n  :page/create\n  (fn [_ [_ title uid]]\n    (let [now (now-ts)]\n      {:transact [{:db/id -1 :node/title title :block/uid uid :create/time now :edit/time now}]})))\n\n\n(reg-event-fx\n  :next-daily-note\n  (fn [{:keys [db]} [_ {:keys [uid title]}]]\n    (let [new-db (update db :daily-notes conj uid)\n          now (now-ts)]\n      (if (db/e-by-av :block/uid uid)\n        {:db new-db}\n        {:db new-db\n         :transact [{:db/id -1 :node/title title :block/uid uid :create/time now :edit/time now}]}))))\n\n\n\n;;; dsdb events (transactions)\n\n\n(def rules\n  '[[(after ?p ?at ?ch ?o)\n     [?p :block/children ?ch]\n     [?ch :block/order ?o]\n     [(> ?o ?at)]]\n    [(inc-after ?p ?at ?ch ?new-o)\n     (after ?p ?at ?ch ?o)\n     [(inc ?o) ?new-o]]\n    [(dec-after ?p ?at ?ch ?new-o)\n     (after ?p ?at ?ch ?o)\n     [(dec ?o) ?new-o]]])\n\n\n(reg-event-fx\n  :backspace\n  (fn [_ [_ _uid]]))\n\n\n;; TODO but how to set focus... especially async\n(defn split-block\n  [uid val sel-start]\n  (let [parent (get-parent [:block/uid uid])\n        block (get-block [:block/uid uid])\n        head (subs val 0 sel-start)\n        tail (subs val sel-start)\n        new-uid (gen-block-uid)\n        new-block {:db/id        -1\n                   :block/order  (inc (:block/order block))\n                   :block/uid    new-uid\n                   :block/open   true\n                   :block/string tail}\n        reindex (->> (d/q '[:find ?ch ?new-o\n                            :in $ % ?p ?at\n                            :where (inc-after ?p ?at ?ch ?new-o)]\n                       @db/dsdb rules (:db/id parent) (:block/order block))\n                  (map (fn [[id order]] {:db/id id :block/order order}))\n                  (concat [new-block]))]\n    {:transact [[:db/add (:db/id block) :block/string head]\n                {:db/id (:db/id parent)\n                 :block/children reindex}]\n     :dispatch [:editing-uid new-uid]}))\n\n\n(defn bump-up\n  [uid val sel-start]\n  (let [parent (get-parent [:block/uid uid])\n        block (get-block [:block/uid uid])\n        tail (subs val sel-start)\n        new-uid (gen-block-uid)\n        new-block {:db/id        -1\n                   :block/order  (:block/order block)\n                   :block/uid    new-uid\n                   :block/open   true\n                   :block/string tail}\n        reindex (->> (d/q '[:find ?ch ?new-o\n                            :in $ % ?p ?at\n                            :where (inc-after ?p ?at ?ch ?new-o)]\n                       @db/dsdb rules (:db/id parent) (inc (:block/order block)))\n                  (map (fn [[id order]] {:db/id id :block/order order}))\n                  (concat [new-block]))]\n    {:transact [[:db/add (:db/id block) :block/string \"\"]\n                {:db/id (:db/id parent) :block/children reindex}]\n     :dispatch [:editing-uid new-uid]}))\n\n\n;; TODO: if enter at end of block, if block open, insert new 0th child. otherwise, add sibling (default behavior right now)\n(reg-event-fx\n  :enter\n  (fn [_ [_ uid val sel-start]]\n    (cond\n      (not (zero? sel-start)) (split-block uid val sel-start)\n      (empty? val) {:dispatch [:unindent uid]}\n      (and (zero? sel-start) val) (bump-up uid val sel-start))))\n\n\n;; TODO: no-op when indenting as the right-most child\n(reg-event-fx\n  :indent\n  (fn [_ [_ uid]]\n    (let [block (get-block [:block/uid uid])\n          parent (get-parent [:block/uid uid])\n          older-sib (->> parent\n                      :block/children\n                      (filter #(= (dec (:block/order block)) (:block/order %)))\n                      first\n                      :db/id\n                      get-block)\n          new-block {:db/id (:db/id block) :block/order (count (:block/children older-sib))}\n          reindex-blocks (->> (d/q '[:find ?ch ?new-o\n                                     :in $ % ?p ?at\n                                     :where (dec-after ?p ?at ?ch ?new-o)]\n                                @db/dsdb rules (:db/id parent) (:block/order block))\n                           (map (fn [[id order]] {:db/id id :block/order order})))]\n      {:transact [[:db/retract (:db/id parent) :block/children (:db/id block)]\n                  {:db/id (:db/id older-sib) :block/children [new-block]} ;; becomes child of older sibling block \u2014 same parent but order-1\n                  {:db/id (:db/id parent) :block/children reindex-blocks}]}))) ;; reindex parent\n\n\n;; TODO: no-op when user tries to unindent to a child out of current context\n(reg-event-fx\n  :unindent\n  (fn [_ [_ uid]]\n    (let [parent (get-parent [:block/uid uid])\n          grandpa (get-parent (:db/id parent))\n          new-block {:block/uid uid :block/order (inc (:block/order parent))}\n          reindex-grandpa (->> (d/q '[:find ?ch ?new-order\n                                      :in $ % ?grandpa ?parent-order\n                                      :where (inc-after ?grandpa ?parent-order ?ch ?new-order)]\n                                 @db/dsdb rules (:db/id grandpa) (:block/order parent))\n                            (map (fn [[id order]] {:db/id id :block/order order}))\n                            (concat [new-block]))]\n      (when (and parent grandpa)\n        {:transact [[:db/retract (:db/id parent) :block/children [:block/uid uid]]\n                    {:db/id (:db/id grandpa) :block/children reindex-grandpa}]}))))\n\n\n(defn target-child\n  [source source-parent target]\n  (let [new-block {:block/uid (:block/uid source) :block/order 0}\n        new-parent-children (->> (d/q '[:find ?ch ?new-order\n                                         :in $ % ?parent ?source-order\n                                         :where (dec-after ?parent ?source-order ?ch ?new-order)]\n                                    @db/dsdb rules (:db/id source-parent) (:block/order source))\n                              (map (fn [[id order]] {:db/id id :block/order order})))\n        new-target-children (->> (d/q '[:find ?ch ?new-order\n                                        :in $ % ?parent ?at\n                                        :where (inc-after ?parent ?at ?ch ?new-order)]\n                                   @db/dsdb rules (:dbid target) 0)\n                              (map (fn [[id order]] {:db/id id :block/order order}))\n                              (concat [new-block]))]\n    [[:db/retract (:db/id source-parent) :block/children [:block/uid (:block/uid source)]] ;; retract source from parent\n     {:db/add (:db/id source-parent) :block/children new-parent-children} ;; reindex parent without source\n     {:db/id (:db/id target) :block/children new-target-children}])) ;; reindex target. include source\n\n\n(defn between\n  \"http://blog.jenkster.com/2013/11/clojure-less-than-greater-than-tip.html\"\n  [s t x]\n  (if (< s t)\n    (and (< s x) (< x t))\n    (and (< t x) (< x s))))\n\n\n(defn target-sibling-same-parent\n  [source target parent]\n  (let [t-order (:block/order target)\n        s-order (:block/order source)\n        new-block {:db/id (:db/id source) :block/order (inc t-order)}\n        inc-or-dec (if (> s-order t-order) inc dec)\n        reindex (->> (d/q '[:find ?ch ?new-order\n                            :in $ ?parent ?s-order ?t-order ?between ?inc-or-dec\n                            :where\n                            [?parent :block/children ?ch]\n                            [?ch :block/order ?order]\n                            [(?between ?s-order ?t-order ?order)]\n                            [(?inc-or-dec ?order) ?new-order]]\n                       @db/dsdb (:db/id parent) s-order t-order between inc-or-dec)\n                  (map (fn [[id order]] {:db/id id :block/order order}))\n                  (concat [new-block]))]\n    [{:db/add (:db/id parent) :block/children reindex}]))\n\n\n(defn target-sibling-diff-parent\n  [source target source-parent target-parent]\n  (let [new-block {:db/id (:db/id source) :block/order (inc (:block/order target))}\n        source-parent-children (->> (d/q '[:find ?ch ?new-order\n                                           :in $ % ?parent ?source-order\n                                           :where (dec-after ?parent ?source-order ?ch ?new-order)]\n                                      @db/dsdb rules (:db/id source-parent) (:block/order source))\n                                 (map (fn [[id order]] {:db/id id :block/order order})))\n        target-parent-children (->> (d/q '[:find ?ch ?new-order\n                                           :in $ % ?parent ?target-order\n                                           :where (inc-after ?parent ?target-order ?ch ?new-order)]\n                                      @db/dsdb rules (:db/id target-parent) (:block/order target))\n                                 (map (fn [[id order]] {:db/id id :block/order order}))\n                                 (concat [new-block]))]\n    [[:db/retract (:db/id source-parent) :block/children (:db/id source)]\n     {:db/id (:db/id source-parent) :block/children source-parent-children} ;; reindex source\n     {:db/id (:db/id target-parent) :block/children target-parent-children}])) ;; reindex target\n\n\n(reg-event-fx\n  :drop-bullet\n  (fn-traced [_ [_ source-uid target-uid kind]]\n             (let [source        (get-block [:block/uid source-uid])\n                   target        (get-block [:block/uid target-uid])\n                   source-parent (get-parent [:block/uid source-uid])\n                   target-parent (get-parent [:block/uid target-uid])]\n               {:transact\n                (cond\n                  ;; child always has same behavior: move to first child of target\n                  (= kind :child) (target-child source source-parent target)\n                  ;; do nothing if target is directly above source\n                  (and (= source-parent target-parent)\n                    (= 1 (- (:block/order source) (:block/order target)))) nil\n                  ;; re-order blocks between source and target\n                  (= source-parent target-parent) (target-sibling-same-parent source target source-parent)\n                  ;;; when parent is different, re-index both source-parent and target-parent\n                  (not= source-parent target-parent) (target-sibling-diff-parent source target source-parent target-parent))})))\n\n;;;; TODO: delete the following logic when re-implementing title merge\n\n;;(defn node-with-title\n;;  [ds title]\n;;  (d/q '[:find ?e .\n;;         :in $ ?title\n;;         :where [?e :node/title ?title]]\n;;       ds title))\n;;\n;;\n;;(defn referencing-blocks\n;;  [ds title]\n;;  (d/q '[:find ?e ?s\n;;         :in $ ?regex\n;;         :where\n;;         [?e :block/string ?s]\n;;         [(re-find ?regex ?s)]]\n;;       ds (patterns/linked title)))\n;;\n;;\n;;(defn rename-refs-tx\n;;  [old-title new-title [eid s]]\n;;  (let [new-s (str/replace\n;;                s\n;;                (patterns/linked old-title)\n;;                (str \"$1$3$4\" new-title \"$2$5\"))]\n;;    [:db/add eid :block/string new-s]))\n;;\n;;\n;;(defn rename-tx\n;;  [ds old-title new-title]\n;;  (let [eid (node-with-title ds old-title)\n;;        blocks (referencing-blocks ds old-title)]\n;;    (->> blocks\n;;         (map (partial rename-refs-tx old-title new-title))\n;;         (into [[:db/add eid :node/title new-title]]))))\n;;\n;;\n;;(reg-event-fx\n;;  :node/renamed\n;;  [(rp/inject-cofx :ds)]\n;;  (fn-traced [{:keys [db ds]} [_ old-title new-title]]\n;;             (when (not= old-title new-title)\n;;               (if (node-with-title ds new-title)\n;;                 {:db (assoc db :merge-prompt {:active true\n;;                                               :old-title old-title\n;;                                               :new-title new-title})\n;;                  :timeout {:action :start\n;;                            :id :merge-prompt\n;;                            :wait 7000\n;;                            :event [:node/merge-canceled]}}\n;;                 {:transact (rename-tx ds old-title new-title)}))))\n;;\n;;\n;;(defn count-children\n;;  [ds title]\n;;  (d/q '[:find (count ?children) .\n;;         :in $ ?title\n;;         :where [?e :node/title ?title]\n;;         [?e :block/children ?children]]\n;;       ds title))\n;;\n;;\n;;(defn get-children-eids\n;;  [ds title]\n;;  (d/q '[:find [?children ...]\n;;         :in $ ?title\n;;         :where [?e :node/title ?title]\n;;         [?e :block/children ?children]]\n;;       ds title))\n;;\n;;\n;;(defn move-blocks-tx\n;;  [ds from-title to-title]\n;;  (let [block-count (count-children ds to-title)\n;;        block-eids (get-children-eids ds from-title)]\n;;    (mapcat (fn [eid]\n;;              (let [order (:block/order (d/pull ds [:block/order] eid))]\n;;                [[:db/add [:node/title to-title] :block/children eid]\n;;                 [:db/add eid :block/order (+ order block-count)]]))\n;;            block-eids)))\n;;\n;;\n;;(reg-event-fx\n;;  :node/merged\n;;  [(rp/inject-cofx :ds)]\n;;  (fn-traced [{:keys [db ds]} [_ primary-title secondary-title]]\n;;             {:db (dissoc db :merge-prompt)\n;;              :timeout {:action :clear\n;;                        :id :merge-prompt}\n;;              :transact (concat [[:db.fn/retractEntity [:node/title secondary-title]]]\n;;                                (move-blocks-tx ds secondary-title primary-title)\n;;                                (rename-tx ds primary-title secondary-title))}))\n;;\n;;\n;;(reg-event-fx\n;;  :node/merge-canceled\n;;  (fn-traced [{:keys [db]} _]\n;;             {:db (dissoc db :merge-prompt)\n;;              :timeout {:action :clear\n;;                        :id :merge-prompt}}))\n\n"]}